<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Administration GNU/Linux - Bases d'unix - Gnuside</title>

		<meta name="description" content="Gnuside - Admin Debian GNU/Linux">
		<meta name="author" content="Gnuside">

		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="css/zenburn.css">

		<!-- gnuside css -->
		<link rel="stylesheet" href="css/presentation.css">

	</head>

	<body>

		<div id="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-state="title">
					<h1>Administration GNU/Linux</h1>
					<h3 class="inverted">Bases d'unix</h3>

					<!--
					<script>
						// Delicously hacky. Look away.
if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) )
	document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')<'+'/p>' );
	</script>
	-->

					<br/>
					<p>2012-05</p>
					<br/>
					<p>
						<i><small>
								<a href="http://www.glenux.net">Glenn Y. Rolland</a> / 
								<a href="http://twitter.com/glenux">@glenux</a>
						</small></i>
					</p>
				</section>	




						<section>
							<h2>Utilisateurs</h2>
							<section>
								<h3>Ajout</h3>
									<ul>
										<li><b>useradd</b> (minimaliste et standart)</li>
										<li><b>adduser</b> (polyvalent mais spécifique Debian)</li>
									</ul>
					<pre><code>root@batcave:~# useradd batman</code></pre>
							</section>


							<section>
								<h3>Modification</h3>
								<div >
									<p>Changer le mot de passe : <b>passwd</b></p>
									<pre><code>batman@batcave:~$ passwd
Changement du mot de passe pour batman.
Mot de passe UNIX (actuel) : 
Entrez le nouveau mot de passe UNIX : 
Retapez le nouveau mot de passe UNIX : 
passwd : le mot de passe a été mis à jour avec succès
batman@batcave:~#
</code></pre>
								</div>
								<div >
									<p>Modifier les propriétés : <b>usermod</b></p>
			<pre><code># usermod batman -c "Bat-Like Avenger"</code></pre>
								</div>
							</section>


							<section>
								<h3>Suppression</h3>
									<ul>
										<li><b>userdel</b> (minimaliste et standart)</li>
										<li><b>deluser</b> (polyvalent mais spécifique Debian)</li>
									</ul>
						<pre><code>root@batcave:~# userdel batman</code></pre>
							</section>



						</section>


						<section>
							<h2>Groupes</h2>
							<section>
								<h3>Ajout</h3>
									<ul>
										<li><b>groupadd</b> (minimaliste et standart)</li>
										<li><b>addgroup</b> (polyvalent mais spécifique Debian)</li>
									</ul>
									<pre><code>root@batcave:~# groupadd batteam
</code></pre>
							</section>


							<section>
								<h3>Suppression</h3>
								<ul>
									<li><b>groupdel</b> (minimaliste et standart)</li>
									<li><b>delgroup</b> (polyvalent mais spécifique Debian)</li>
								</ul>
								<pre><code>root@batcave:~# groupdel batteam
</code></pre>
							</section>
						</section>

						<section>
							<h2>Utilisateurs et groupes</h2>
							<section>
								<h3>Quelques fichiers importants</h3>
								<ul>
									<li ><a href="#2/3">/etc/passwd</a> - utilisateurs</li>
									<li ><a href="#2/4">/etc/shadow</a> - mots de passe</li>
									<li ><a href="#2/4">/etc/groups</a> - groupes</li>
								</ul>
							</section>

							<section>
								<h3>/etc/passwd</h3>
								<div >
									<p>Un format super-simple</p>
									<p><small>
											<b>username</b> :
											<b>password</b> : 
											<b>user id (UID)</b> : 
											<b>group id (GID)</b> : 
											<b>description</b> : 
											<b>home</b> : 
											<b>shell</b>
										</small>
									</p>
								</div>
								<div >
									<pre>
			<code>
root:x:0:0:root:/root:/bin/bash 
daemon:x:1:1:daemon:/usr/sbin:/bin/sh 
bin:x:2:2:bin:/bin:/bin/sh 
sys:x:3:3:sys:/dev:/bin/sh 
sync:x:4:65534:sync:/bin:/bin/sync 
games:x:5:60:games:/usr/games:/bin/sh 
man:x:6:12:man:/var/cache/man:/bin/sh 
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh 

...

batman:x:1001:1001:Bruce Wayne:/home/batman:/bin/bash
			</code>
			</pre>
								</div>
							</section>

							<section>
								<h3>/etc/shadow</h3>
								<div >
									<p>Un format super-simple :</p>
									<p><small>
											<b>username</b> :
											<b>password</b> : 
											<b>date du password</b> : 
											<b>etc (age min, age max...)</b>
										</small>
									</p>
								</div>
								<div >
<pre><code>
root:$6$gjBGnh.Q$RPnyfdvkhXHTP4xtcrVO4I7lGIyp8G3IZiQjjj8cBDikCE3ePuPBuzAex1ip1KVLFbe5GYKiGNxAybPU783Bk0:15174:0:99999:7:::
daemon:*:15172:0:99999:7:::
bin:*:15172:0:99999:7:::
sys:*:15172:0:99999:7:::
sync:*:15172:0:99999:7:::
games:*:15172:0:99999:7:::
man:*:15172:0:99999:7:::
lp:*:15172:0:99999:7:::
mail:*:15172:0:99999:7:::
news:*:15172:0:99999:7:::

...

batman:$6$MdCbGr5F$PfyMqt8MC2EQjzczwdLuqwTxAbm/BqfErwU7gvd02vGQbxL.ZIg5tSNacfp/4pmfwodDYioXTSon2VxTZnQYW/:15174:0:99999:7:::
</code></pre>
								</div>
							</section>


							<section>
								<h3>/etc/group</h3>
								<div >
									<p>Un format super-simple :</p>
									<p><small>
											<b>group name</b> :
											<b>password</b> : 
											<b>group id (GID)</b> : 
											<b>group list</b>
										</small>
									</p>
									<div >
<pre><code>
root:x:0:
daemon:x:1:

...

lp:x:7:
mail:x:8:
news:x:9:
cdrom:x:24:batman
floppy:x:25:batman
audio:x:29:batman,pulse

...

batman:x:1002:
robin:x:1003:
batteam:x:1004:batman,robin,batgirl
</code></pre>
									</div>
								</section>



						<section>
							<h3>UIDs et GIDs</h3>
							<div >
								<p>Valeurs de 0 à 65534</p>
								<ul>
									<li ><b>0</b> : root (administrateur)</li>
									<li ><b>1-99</b> :
										Utilisateurs système, alloués par le projet Debian
									</li>
									<li ><b>100-999</b> :
										Utilisateurs système, non-alloués par le projet Debian</li>
									<li ><b>1000-59999</b> : Utilisateurs “normaux”</li>
									<li ><b>60000-64999</b> : Utilisateurs “normaux” gérés par Debian</li>
									<li ><b>65000-65533</b> : Réservé</li>
									<li ><b>65534</b> : Utilisateur "nobody" (sans droits ni permissions)
									</li>
								</ul>
							</section>


							<section>
								<h3>Quelques outils</h3>
								<ul>
									<li ><b>id</b> - afficher les identifiants d'utilisateur et de groupe</li>
									<li ><b>groups</b> -  affiche les groupes auxquels appartient un utilisateur</li>
									<li ><b>getent</b> - récupère des entrées depuis les bases de données d'administration</li>
								</ul>
							</section>


							<section>
								<h3>Configuration des comptes utilisateurs</h3>
								<ul>
									<li><b>/etc/skel.conf</b></li>
									<li><b>/etc/skel/*</b></li>
									<li><b>/etc/adduser.conf</b></li>
									<li><b>/etc/default/adduser</b></li>
								</ul>
							</section>
						</section>



						<section>
							<h2>Installation de logiciels</h2>
							<p>L'installation peut varier
								<span ><b>selon le logiciel</b></span><br/>
								<span >et <b>selon la distribution</b> !</span>
							</p>
							<br />
							<p >En général, à partir du <i>code source</i> :</p>
							<ul>
								<li ><b>./configure</b> (detecte l'environnement et configure)</li>
								<li ><b>make</b> (compile les sources en un binaire exécutable)</li>
								<li ><b>make install</b> (installe sur le système)</li>
							</ul>
							<br />
							<br />
							<p >Démonstration !</p>
						</section>



						<section>
							<h2>Archivage</h2>
							<section>
								<ul>
									<li ><b>tar</b> - archivage de fichiers</li>
									<li ><b>cpio</b> - archivage de fichiers (ancien)</li>
									<li ><b>ar</b> - archivage de fichiers (très ancien)</li>
									<li ><b>rsync</b> - archivage de fichiers</li>
									<li ><b>dd</b> - copie de disques</li>
									<li ><b>partimage</b> copies de disques</li>
								</ul>
							</section>

							<section>
								<h3>tar : vue d'ensemble</h3>
								<ul>
									<li >sans compression</li>
									<li >outils tiers pour compresser: <b>gzip</b>, <b>bzip2</b>, <b>7z</b>...</li>
									<li >dans tar, paramètres : <b>-z</b> (gzip),<b>-j</b> (bzip2), <b>-a</b> (automatique)</li>
								</ul>
							</section>


							<section>
								<h3>tar : créer une archive</h3>
								<small>(au format <b>tar.gz</b>)</small>
<pre><code>tar czvf archives-batcave.tar.bz2 /home/batman/documents
</code></pre>
<pre><code>tar cvf archives-batcave.tar /home/batman/documents
gzip archives-batcave.tar
</code></pre>
							</section>


							<section>
								<h3>tar : lister une archive</h3>
								<small>(au format <b>tar.gz</b>)</small>
<pre><code>gunzip archives-batcave.tar.gz
tar tvf archives-batcave.tar
</code></pre>

<pre><code>tar tavf archives-batcave.tar.gz
</code></pre>
							</section>

							<section>
								<h3>tar : restaurer une archive</h3>
								<small>(au format <b>tar.gz</b>)</small>
<pre><code>gunzip archives-batcave.tar.gz
tar xvf archives-batcave.tar
</code></pre>

<pre><code>tar xavf archives-batcave.tar.gz
</code></pre>
							</section>



							<section>
								<h3>tar : trucs et astuces</h3>
									<p>Peut aussi servir à copier des disques</p>
<pre><code>(cd /anciendisque ; tar cf - . ) | (cd /nouveaudisque ; tar xvf - )
</code></pre>
							</section>


							<section>
								<h3>cpio</h3>
								<ul>
									<li>Obsolete depuis tar</li>
									<li>Format des packages <em>.rpm</em></li>
								</ul>
							</section>


							<section>
								<h3>cpio : créer une archive</h3>
								<ul>
									<li><b>-o</b>  : créer une archive</li>
									<li><b>-F</b> : nom de l'archive (sinon stdio / stdou)</li>
									<li><b>-H <em>format</em></b> : format à utiliser</li>
									<li><b>-i</b> : restaurer l'archive</li>
								</ul>	
								<pre><code>find documents | cpio -o -H tar -F archives-batcave.tar
</code></pre>
							</section>


							<section>
								<h3>cpio : lister une archive</h3>
								<ul>
									<li><b>-F</b> : nom de l'archive (sinon stdio / stdou)</li>
									<li><b>-i</b> : restaurer l'archive</li>
									<li><b>-t</b> : afficher la table</li>
								</ul>	
						<pre><code>cpio -it -F perl-files.tar
</code></pre>
							</section>


							<section>
								<h3>cpio : restaurer une archive</h3>
								<ul>
									<li><b>-F</b> : nom de l'archive (sinon stdio / stdou)</li>
									<li><b>-i</b> : restaurer l'archive</li>
								</ul>	
								<pre><code>cpio -i -F archives-batcave.tar
</code></pre>
							</section>
						</section>


						<section>
							<h2>Sauvegarde</h2>
							<section>
								<h3>dd : copie et conversion</h3>
								<ul>
									<li><b>if</b> : source (input file)</li>
									<li><b>of</b> : destination (output file)</li>
									<li><b>bs</b> : taille des blocks (block side)</li>
									<li><b>count</b> : nombre de blocks</li>
								</ul>
<pre><code>dd if=/foo of=/bar bs=1M count=1000
</code></pre>
								<p>Ne résiste pas aux erreurs disque</p>
								<p>Une alternative : <b>dd_rescue</b></p>
							</section>


							<section>
								<h3>rsync : vue d'ensemble</h3>
								<ul>
									<li>Synchronise deux répertoires</li>
									<li>Synchronisation locale ou distante</li>
									<li>Disponible pour toutes plate-formes</li>
									<li>Sécurisé via SSH</li>
								</ul>
							</section>
							<section>
								<h3>rsync : synchronisation</h3>

								<ul>
									<li><b>-a</b> : archive</li>
									<li><b>-v</b> : verbose</li>
									<li><b>-z</b> : compression</li>
								</ul>

								<pre><code>rsync -e ssh \
    -avz \
    batman@batcave.batdomain:/home/batman/ \
    /home/bruce/backups/batman/
</code></pre>
							</section>


							<section>
								<h3>partimage</h3>
								<p>Outil complet d'archivage et restauration de disques (voir la doc...)</p>
							</section>
						</section>



						<section>
							<h2>Démarrage système</h2>

							<section>
								<h3>Lilo / Grub</h3>
								<p>DEMO</p>
							</section>


							<section>
								<h3>Le noyau et ses arguments</h3>
								<p>DEMO</p>
							</section>
						</section>


						<section>
							<h2>Init et services</h2>

							<section>
								<h3>Le processus init</h3>

								<p>DEMO</p>
							</section>


							<section>
								<h3>Niveaux de démarrage</h3>

								<ul>
									<li><b>0</b> : arrêt du systeme</li>
									<li><b>1</b> : utilisateur unique (single)</li>
									<li><b>2 à 5</b> : multi-utilisateur</li>
									<li><b>6</b> : redémarrage</li>
								</ul>
							</section>


							<section>
								<h3>Utiliser init</h3>

								<p>Exemple: passer du niveau de courant au niveau 1</p>
								<pre><code># init 1</code></pre>
							</section>


							<section>
								<h3>Lancement des services</h3>

								<ul>
									<li>Scripts dans <b>/etc/init.d/</b></li>
									<li>Démarrage controlé par <b>/etc/rc*.d/</b></li>
								</ul>

								<pre><code># ln -s /etc/init.d/batcave_setup /etc/rc0.d/K20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc1.d/S20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc2.d/S20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc3.d/S20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc4.d/S20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc5.d/S20mon_script
# ln -s /etc/init.d/batcave_setup /etc/rc6.d/K20mon_script
</code><pre>
							</section>


							<section>
								<h3>Le fichier inittab</h3>

								<p>Fixer le  niveau par défaut</p>
								<pre><code>id:2:initdefault:</code></pre>
							</section>


							<section>
							<h3>Arrêt et redémarrage</h3>

							<ul>
								<li><b>halt</b></li>
								<li><b>shutdown</b></li>
								<li><b>reboot</b></li>
							</ul>
							</section>
						</section>


					<section>
						<h2>Fin</h2>
						<section>
							<h3>Références</h3>
							<ul>
								<li><a href="http://www.debian.org/doc/debian-policy/ch-opersys.html">Debian policy Manual</a></li>
								<li><a href="http://doc.ubuntu-fr.org/rsync">Doc Ubuntu : Rsync</a></li>
							</ul>
						</section>


						<section>
							<h3>Questions ?</h3>
						</section>


						<section>
							<h3>Merci !</h3>
						</section>
					</section>

					</div> <!-- .slides -->

					<!-- The navigational controls UI -->
					<aside class="controls">
						<a class="left" href="#">&#x25C4;</a>
						<a class="right" href="#">&#x25BA;</a>
						<a class="up" href="#">&#x25B2;</a>
						<a class="down" href="#">&#x25BC;</a>
					</aside>

					<!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
					<div class="progress"><span></span></div>
				</div> <!-- #reveal -->

				<script src="js/reveal.js"></script>
				<script src="lib/highlight.js"></script>
				<script>
					// Parse the query string into a key/value object
				var query = {};
location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
		query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
		} );

Reveal.initialize({
		// Display controls in the bottom right corner
controls: true,

// Display a presentation progress bar
progress: true,

// If true; each slide will be pushed to the browser history
history: true,

// Flags if mouse wheel navigation should be enabled
mouseWheel: true,

// Apply a 3D roll to links on hover
rollingLinks: false,
//true,

// UI style
theme: query.theme || 'default', // default/neon

// Transition style
transition: query.transition || 'linear'  //default' // default/cube/page/concave/linear(2d)
});

hljs.initHighlightingOnLoad();
	</script>

	</body>
</html>
