<!doctype html>  
<html lang="en">

    <head>
	<meta charset="utf-8">

	<title>Administration GNU/Linux - Gestion de logiciels (Debian) - Gnuside</title>

	<meta name="description" content="Administration GNU/Linux - Gestion de logiciels (Debian) - Gnuside">
	<meta name="author" content="Gnuside">

	<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/zenburn.css">

	<!-- gnuside css -->
	<link rel="stylesheet" href="css/presentation.css">

    </head>

    <body>

	<div id="reveal">

	    <!-- Any section element inside of this container is displayed as a slide -->
	    <div class="slides">
		<section data-state="title">
		<h1>Administration GNU/Linux</h1>
		<h3 class="inverted">Gestion des logiciels (Debian)</h3>

		<br><br>
		<p>2012-05</p>
		<br><br>
		<i><small>
			<a href="http://www.gnuside.com">Gnuside</a> / 
			<a href="http://twitter.com/gnuside">@gnuside</a></small></i>
		</section>	


		<section>
			<h2>Spécificités de Debian</h2>

			<ul>
				<li>APT</li>
				<li>Dpkg</li>
			</ul>
		</section>

		<section>
			<h2>Définitions</h2>

			<section>
				<h3>Paquets logiciels (packages)</h3>
				<ul>
					<li>Applications, biobliothèques, media ...</li>
					<li>Binaires ou sources</li>
					<li>Des informations de gestion : <b>dépendances</b>, etc.</li>
					<li>Au format <b>deb</b></li>
				</ul>
			</section>

			<section>
				<h3>Dépendances</h3>

				<p>= <b>Prérequis logiciel</b></p>

				<p>
				Exemple: dépendances pour <em>firefox (12.0-3)</em></p>
				<small>
				<ul>
					<li>libc6 (>= 2.4)</li>
					<li>libgdk-pixbuf2.0-0 (>= 2.22.0)</li>
					<li>libglib2.0-0 (>= 2.16.0)</li>
					<li>libgtk2.0-0 (>= 2.10)</li>
					<li>libnspr4-0d (>= 1.8.0.10)</li>
					<li>libstdc++6 (>= 4.1.1)</li>
					<li>fontconfig</li>
					<li>procps</li>
					<li>debianutils (>= 1.16)</li>
					<li>xulrunner-12.0 (>= 12.0-3)</li>
				</ul>
				</small>
				</p>

			</section>
			<section>
				<h3>Branches</h3>

				<ul>
					<li><b>stable</b></li>
					<li><b>testing</b></li>
					<li><b>unstable</b></li>
					<li><i>experimental</i></li>
				</ul>

				<br/>
				<br/>

				<p>Vie d'un paquet : unstable &harr; testing &rarr; stable
				</p>
			</section>

			<section>
				<h3>Dépots</h3>

				<ul>
					<li>Ensemble de paquets</li>
					<li>Pour une ou plusieurs branches</li>
					<li>Officiels ou non : <b>main</b>, <b>contrib</b>, <b>non-free</b></li>
					<li>Accessibles localement, en FTP, HTTP ... et Bittorent !</li>
				</ul>
			</section>

		</section>



		<section>
			<h2>La commande dpkg</h2>

			<section>
				<h3><b>D</b>ebian <b>P</b>ac<b>k</b>a<b>g</b>e</h3>

				<ul>
					<li><b>Installer</b> des paquets</li>
					<li><b>Supprimer</b> des paquets</li>
					<li><b>Lister</b> les paquets</li>
					<li><b>Lister</b> le contenu des paquets</li>
				</ul>
			</section>	

			<section>
				<h3>Installer des paquets</h3>
				<p><b>dpkg -i <em>nom-du-fichier.deb</em></b></p>


<pre><code># wget http://ftp.fr.debian.org/debian/pool/main/s/snarf/snarf_7.0-5_amd64.deb
# dpkg -i snarf_7.0-5_amd64.deb 
Selecting previously unselected package snarf.
(Lecture de la base de données... 
  905167 fichiers et répertoires déjà installés.)
Dépaquetage de snarf (à partir de snarf_7.0-5_amd64.deb) ...
Paramétrage de snarf (7.0-5) ...
Traitement des actions différées (« triggers ») pour « man-db »...
</code></pre>

			</section>

			<section>
				<h3>Désinstaller des paquets</h3>
				<p><b>dpkg -r <em>nom-du-paquet</em></b></p>

<pre><code># dpkg -r snarf
(Lecture de la base de données... 
  905173 fichiers et répertoires déjà installés.)
Suppression de snarf ...
Traitement des actions différées (« triggers ») pour « man-db »...
</code></pre>
			</section>

			<section>
				<h3>Lister les paquets</h3>
				<p><b>dpkg -l <em>[nom-du-paquet]</em></b></p>
				<pre><code>$ dpkg -l snarf
Souhait=inconnU/Installé/suppRimé/Purgé/H=à garder
| État=Non/Installé/fichier-Config/dépaqUeté/échec-conFig/
| H=semi-installé/W=attend-traitement-déclenchements
|/ Err?=(aucune)/besoin Réinstallation (État,Err: majuscule=mauvais)
||/ Nom           Version       Description
+++-=============-=============-===============================
ii  snarf         7.0-5         A command-line URL grabber
</code></pre>
			</section>

			<section>
				<h3>Lister le contenu des paquets</h3>
				<p><b>dpkg -L <em>nom-du-paquet</em></b></p>
				<pre><code>$ dpkg -L snarf
/.
/usr
/usr/bin
/usr/bin/snarf
/usr/share
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/snarf.1.gz
/usr/share/doc
/usr/share/doc/snarf
/usr/share/doc/snarf/README
/usr/share/doc/snarf/TODO
/usr/share/doc/snarf/copyright
/usr/share/doc/snarf/changelog.gz
/usr/share/doc/snarf/changelog.Debian.gz
</code></pre>
			</section>
		</section>



		<section>
			<h2>Le système APT</h2>

			<section>
				<h3><b>A</b>dvanced <b>P</b>ackage <b>T</b>ool</h3>

				<p>Un ensemble d'outils</p>
				<p>Basés sur <em>dpkg</em></p>
				<ul>
					<li>apt-get</li>
					<li>apt-cache</li>
					<li>apt-file</li>
					<li>...</li>
				</ul>
			</section>

			<section>
				<h3>Usages</h3>
				<ul>
					<li><b>Rechercher</b> des paquets</li>
					<li><b>Obtenir</b> des informations sur les paquets</li>
					<li><b>Installer</b> des paquets</li>
					<li><b>Supprimer</b> des paquets</li>
					<li><b>Mettre à jour</b> les paquets</li>
					<li><b>Gérer les dépendances</b> entre paquets</li>
					<li><b>Résoudre les conflits</b></li>
					<li>...</li>
				</ul>
			</section>

			<!-- notion de dépendances, lien avec dpkg -->

			<section>
				<h3>Information sur les paquets</h3>
				<p>À mettre à jour avant toute commande APT</p>
				<p><b>apt-get update</b></p>
				<pre><code># apt-get update
Atteint http://ftp.fr.debian.org unstable/main Sources/DiffIndex
Atteint http://ftp.fr.debian.org unstable/main amd64 Packages/DiffIndex
Atteint http://ftp.fr.debian.org unstable/main TranslationIndex
Atteint http://ftp.fr.debian.org unstable/main Translation-fr
Atteint http://ftp.fr.debian.org unstable/main Translation-en
Atteint http://ftp.fr.debian.org stable/main Sources
Atteint http://ftp.fr.debian.org stable/main amd64 Packages
Atteint http://ftp.fr.debian.org stable/main TranslationIndex
Atteint http://ftp.fr.debian.org stable/main Translation-fr_FR
Atteint http://ftp.fr.debian.org stable/main Translation-fr
11,9 ko réceptionnés en 3s (3 174 o/s)
Lecture des listes de paquets... Fait
</code></pre>
			</section>



			<section>
				<h3>Rechercher</h3>

				<p><b>apt-cache search <em>mot-clef [mot-clef-2] [...]</em></b></p>
				<pre><code>$ apt-cache search url grabber
snarf - A command-line URL grabber
python-urlgrabber - A high-level cross-protocol url-grabber
</code></pre>
			</section>


			<section>
				<h3>S'informer sur le dépot</h3>

				<p><b>apt-cache policy <em>nom-du-paquet</em></b></p>
				<pre><code>$ apt-cache policy snarf
snarf:
  Installé : 7.0-5
  Candidat : 7.0-5
 Table de version :
 *** 7.0-5 0
        500 http://ftp.fr.debian.org/debian/ stable/main amd64 Packages
        990 http://ftp.fr.debian.org/debian/ testing/main amd64 Packages
        500 http://ftp.fr.debian.org/debian/ unstable/main amd64 Packages
        100 /var/lib/dpkg/status
</code></pre>
			</section>



			<section>
				<h3>S'informer sur le paquet</h3>

				<p><b>apt-cache show <em>nom-du-paquet</em></b></p>
				<pre><code>$ apt-cache show snarf
Package: snarf
Priority: optional
Section: net
Installed-Size: 88
Maintainer: Noah Meyerhans <noahm@debian.org>
Architecture: amd64
Version: 7.0-5
Depends: libc6 (>= 2.3.5-1)
Filename: pool/main/s/snarf/snarf_7.0-5_amd64.deb
Size: 23074
MD5sum: 4a5b2ee4218e4da6f0fb6eb453e20ac3
SHA1: ec27aa66028b942551a5179e043be7b8e22f2df9
SHA256: 21e70d39a942b328e8a29f573e3b4897808a91e74b358e6fe0fb49fb316bdaa0
Description-en: A command-line URL grabber
 Snarf is a utility to retrieve files via the http and ftp protocols. It
 supports http redirect, http and ftp resume, http and ftp
 authentication, and other neat things.  Its functionality is similar to
 that of wget, but with a much smaller binary.
Tag: interface::commandline, protocol::ftp, protocol::http, role::program, scope::utility, use::downloading
</code></pre>
			</section>

			<section>
				<h3>Installer des paquets</h3>

				<p><b>apt-get install <em>nom-du-paquet [nom-du-paquet2] [...]</em></b></p>
				<pre><code>
# apt-get install snarf
Lecture des listes de paquets... Fait
Construction de l'arbre des dépendances       
Lecture des informations d'état... Fait
Les NOUVEAUX paquets suivants seront installés :
  snarf
0 mis à jour, 1 nouvellement installés, 0 à enlever et 2780 non mis à jour.
Il est nécessaire de prendre 0 o/23,1 ko dans les archives.
Après cette opération, 90,1 ko d'espace disque supplémentaires seront utilisés.
Retrieving bug reports... Done
Parsing Found/Fixed information... Done
Selecting previously unselected package snarf.
(Lecture de la base de données... 877032 fichiers et répertoires déjà installés.)
Dépaquetage de snarf (à partir de .../archives/snarf_7.0-5_amd64.deb) ...
Traitement des actions différées (« triggers ») pour « man-db »...
Paramétrage de snarf (7.0-5) ...
</code></pre>
			</section>

			<section>
				<h3>Désinstaller des paquets</h3>
				<p><b>apt-get remove <em>nom-du-paquet [nom-du-paquet2] [...]</em></b></p>
<pre><code># apt-get remove snarf
Lecture des listes de paquets... Fait
Construction de l'arbre des dépendances       
Lecture des informations d'état... Fait
Les paquets suivants seront ENLEVÉS :
  snarf
0 mis à jour, 0 nouvellement installés, 1 à enlever et 2780 non mis à jour.
Après cette opération, 90,1 ko d'espace disque seront libérés.
Souhaitez-vous continuer [O/n] ? 
(Lecture de la base de données... 877038 fichiers et répertoires déjà installés.)
Suppression de snarf ...
Traitement des actions différées (« triggers ») pour « man-db »...
</code></pre>
			</section>

			<section>
				<h3>Mettre à jour</h3>
				<p><b>apt-get upgrade</b></p>
				<ul>
					<li>Préserve les dépendances existantes</li>
					<li>Fait des changement minimaux</li>
				</ul>

				<br/><br/>
				<p><b>apt-get dist-upgrade</b></p>
				<ul>
					<li>Résoud les nouvelles dépendances</li>
					<li>Tente de contourner les conflits</li>
					<li>Peut introduire de nouveaux packages</li>
				</ul>
			</section>

			<section>
				<h3>Régler les problèmes</h3>

				<p>Forcer l'installation d'un paquet :<br/>
				<b>dpkg -i --force-<em>quelquechose</em> <em>nom-du-fichier.deb</em></b></p>

				<br/>
				<p>Forcer l'installation d'un paquet issu d'une branche donnée :<br/>
				<b>apt-get install -t <em>branche</em> <em>nom-du-paquet</em></b></p>

				<br/>
				<p>Reprendre l'installation (ex: après une interruption) :<br/>
				<b>apt-get -f install</b></p>
			</section>

		</section>


		<section>
			<h2>Configuration de APT</h2>

			<section>
			<h3>Emplacement</h3>
			<p>Dans le répertoire <b>/etc/apt/</b></p>
			</section>

			<section>
				<h3>sources.list</h3>

<ul>
<li>Configuration des dépots pour APT</li>
<li>Format simple : <b>deb <em>url</em> <em>branch</em> <em>archive-area</em></b></li>
<li>Fragmenté dans <b>/etc/apt/sources.list.d/</b></li>
</ul>

<br/><br/>
<p>Extrait de <em>/etc/apt/sources.list</em> :</p>

<pre><code>## stable
deb http://ftp.fr.debian.org/debian/ stable main contrib non-free
deb-src http://ftp.fr.debian.org/debian/ stable main contrib non-free

## stable/security
deb http://security.debian.org/ stable/updates main contrib non-free
deb-src http://security.debian.org/ stable/updates main contrib non-free

## testing 
deb http://ftp.fr.debian.org/debian/ testing main contrib non-free
deb-src http://ftp.fr.debian.org/debian/ testing main contrib non-free

...
</code></pre>
			</section>

			<section>
				<h3>apt.conf</h3>

					<ul>
						<li>Définir la branche par défaut</li>
						<li>Régler les options réseau</li>
						<li>Changer le comportement par défaut</li>
						<li>...</li>
					</ul>

					<br/>
					<br/>
					<p>Voir <b>man apt.conf</b> pour la syntaxe !</p>

				</ul>
			</section>

			<section>
				<h3>preferences</h3>
				<ul>
					<li>Pour changer les priorités entre les branches</li>
					<li>Pour figer des paquets (<em>pinning</em>)</li>
				</ul>

				<br/>
				<br/>
				<p>Voir <b>man apt_preferences</b> pour la syntaxe !</p>
			</section>

		</section>

		<section>
			<h3>Report de bug</h3>

			<p><b>reportbug</b></p>
		</section>


		<section>
			<h2>Fin</h2>

			<section>
		    <h3>Références</h3>
			<ul>
				<li><a href="http://newbiedoc.sourceforge.net/tutorials/apt-get-intro/info.html">Installing Debian Software with the Advanced Package Tool</a></li>
			</ul>
			</section>

			<section>
		    <h3>Questions ?</h3>
			</section>

			<section>
		    <h3>Merci !</h3>
			</section>
		</section>
	    </div>

	    <!-- The navigational controls UI -->
	    <aside class="controls">
	    <a class="left" href="#">&#x25C4;</a>
	    <a class="right" href="#">&#x25BA;</a>
	    <a class="up" href="#">&#x25B2;</a>
	    <a class="down" href="#">&#x25BC;</a>
	    </aside>

	    <!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
	    <div class="progress"><span></span></div>
	</div>

	<script src="js/reveal.js"></script>
	<script src="lib/highlight.js"></script>
	<script>
	    // Parse the query string into a key/value object
	    var query = {};
	    location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
		query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
	    } );

	    Reveal.initialize({
		// Display controls in the bottom right corner
		controls: true,

		// Display a presentation progress bar
		progress: true,

		// If true; each slide will be pushed to the browser history
		history: true,

		// Flags if mouse wheel navigation should be enabled
		mouseWheel: true,

		// Apply a 3D roll to links on hover
		rollingLinks: false,
		//true,

		// UI style
		theme: query.theme || 'default', // default/neon

		// Transition style
		transition: query.transition || 'linear'  //default' // default/cube/page/concave/linear(2d)
	    });

	    hljs.initHighlightingOnLoad();
	</script>

    </body>
</html>
